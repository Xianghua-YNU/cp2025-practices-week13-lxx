# 探测周期性 - 实验报告

## 1. 实验目的

本实验旨在通过傅里叶变换分析太阳黑子数据的周期性，具体目标包括：
- 学习使用傅里叶变换分析时间序列数据中的周期性特征
- 掌握功率谱的计算和解释方法
- 理解太阳黑子活动的周期性规律及其物理意义

## 2. 方法简述

实验采用以下方法进行分析：

1. **数据获取和预处理**：从提供的文本文件中读取1749-2025年的太阳黑子数据，提取月份和黑子数列。对缺失值进行线性插值处理，并进行标准化。

2. **傅里叶变换**：使用快速傅里叶变换(FFT)算法将时域信号转换为频域表示。计算信号的离散傅里叶变换系数，并取绝对值得到幅度谱。

3. **功率谱计算**：将傅里叶变换结果的幅度平方后除以数据点数，得到功率谱密度估计。频率轴转换为实际周期(年)。

4. **峰值检测**：使用scipy.signal.find_peaks函数识别功率谱中的显著峰值，设置高度阈值为功率谱最大值的10%，筛选出主要周期成分。

5. **周期确定**：将峰值对应的频率转换为实际周期，并与已知的太阳活动周期(约11年)进行对比验证。

## 3. 实验结果

### 3.1 太阳黑子数据时间序列

![image](https://github.com/user-attachments/assets/64cba800-34c6-4f1c-b077-7575cbca22b5)


图像说明：
时间序列图显示了1749-2025年间太阳黑子数的变化情况。可以观察到明显的周期性波动，大约每10-12年出现一次高峰。黑子数量在19世纪后期和20世纪中期达到较高水平，而在18世纪末和21世纪初相对较低。

### 3.2 功率谱分析

![image](https://github.com/user-attachments/assets/006df5e6-f4be-4aa8-a4da-be813e50b1f3)


图像说明：
功率谱分析显示在周期约11年处有一个显著的主峰，对应已知的太阳活动周期。此外，在5.5年和22年处也可见次峰，可能反映太阳活动的谐波和倍周期成分。高频部分功率较低，表明太阳黑子活动主要受低频周期驱动。

### 3.3 周期确定

| 确定方法 | 周期（月） | 周期（年） |
|---------|----------|----------|
| 目视估计 | 132 | 11.0 |
| 傅里叶分析 | 134 | 11.2 |

两种方法的相对误差：1.8%

## 4. 分析与讨论

### 4.1 太阳黑子周期的物理意义

太阳黑子是由太阳内部磁流管浮出光球层形成的暗区，其周期性变化源于太阳磁场的周期性重组（发电机理论）。太阳磁场每11年反转一次，形成22年的完整磁周期。黑子活动影响太阳辐射输出和太阳风强度，进而影响地球：

1. 气候影响：黑子极小期(如蒙德极小期)常对应地球小冰期
2. 空间天气：强活动期会干扰无线电通信和卫星运行
3. 极光现象：太阳风增强导致极光活动频繁

### 4.2 傅里叶变换方法的优缺点

**优点**：
- 能精确量化周期成分的频率和强度
- 适用于分析平稳周期性信号
- 计算效率高(FFT算法)

**局限性**：
- 假设信号平稳，无法反映周期随时间的变化
- 对非周期趋势敏感，需先去除趋势
- 分辨率受数据长度限制

替代方法包括小波变换(可分析时变周期)、自相关函数(直接检测周期)和Lomb-Scargle周期图(处理非均匀采样)。

### 4.3 思考题

1. 长期趋势会在功率谱低频区产生虚假峰值，干扰周期检测。处理方法包括：差分法去趋势、多项式拟合后减去趋势项、使用带通滤波器等。

2. 使用100年数据会降低周期分辨率，增加频率间隔，可能导致无法准确识别11年周期。但可以更好分析周期幅度的长期变化。

## 5. 结论

本实验通过傅里叶分析确认太阳黑子活动存在约11.2年的主周期，与太阳磁活动周期一致。功率谱还揭示了可能的谐波成分。傅里叶变换是分析天文周期信号的有效工具，但需注意其局限性。实验结果加深了对太阳活动规律及其地球影响的理解。

## 核心代码片段

```python
import numpy as np
from scipy.fft import fft, fftfreq
from scipy.signal import find_peaks

def compute_power_spectrum(data, sample_rate=12):
    n = len(data)
    yf = fft(data)
    power = np.abs(yf)**2 / n
    freqs = fftfreq(n, 1/sample_rate)
    return freqs[:n//2], power[:n//2]

def detect_periods(power, freqs, min_prominence=0.1):
    peaks, _ = find_peaks(power, prominence=min_prominence*max(power))
    periods = 1/freqs[peaks]  # 转换为周期(年)
    return periods, peaks
```

代码说明：
1. `compute_power_spectrum`函数计算输入数据的功率谱，返回正频率部分
2. `detect_periods`使用峰值检测算法识别显著周期
3. 采样率设为12(月/年)以直接获得年周期
4. 最小峰突出度设为最大功率的10%以筛选主要周期
