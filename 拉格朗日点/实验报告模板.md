# 拉格朗日点 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解地球-月球系统中L1拉格朗日点的位置，具体目标包括：
- 理解拉格朗日点的物理意义及其在天体力学中的重要性
- 推导L1点位置满足的方程
- 实现并比较不同的数值求根方法（牛顿法、弦截法）
- 分析数值方法的收敛性和精度

## 2. 方法简述

L1点位置方程的推导基于三力平衡原理：地球引力、月球引力和离心力。在旋转参考系中，卫星在L1点保持相对静止的条件是这三个力的矢量和为零，由此得到非线性方程。

牛顿法实现策略：
1. 使用函数值和导数值进行迭代
2. 迭代公式：x_{n+1} = x_n - f(x_n)/f'(x_n)
3. 设置双重收敛条件：函数值容差和变量变化容差

弦截法实现策略：
1. 利用两点函数值近似导数
2. 迭代公式：x_{n+1} = x_n - f(x_n)*(x_n-x_{n-1})/(f(x_n)-f(x_{n-1}))
3. 同样设置双重收敛条件

初值选择依据：
1. 牛顿法初值3.5×10⁸m（地月距离的90%处）
2. 弦截法区间[3.2×10⁸,3.7×10⁸]m
3. 基于L1点应位于地球和月球之间且靠近月球的物理判断

## 3. 实验结果

### 3.1 L1点位置方程可视化

![image](https://github.com/user-attachments/assets/85264bbd-2088-43c4-9b2b-7c4a51f4cc2d)


图像说明：
图像显示方程在3.0×10⁸到3.8×10⁸米范围内单调递减，存在唯一零点。零点位置约3.26×10⁸米处对应L1点位置，即地球和月球引力的平衡点。

### 3.2 数值求解结果

| 求解方法 | L1点位置 (m) | 相对于地月距离的比例 | 迭代次数 | 是否收敛 |
|---------|------------|-------------------|---------|--------|
| 牛顿法   | 3.26376×10⁸ | 0.84893           | 5       | 是      |
| 弦截法   | 3.26376×10⁸ | 0.84893           | 6       | 是      |
| fsolve  | 3.26376×10⁸ | 0.84893           | -       | -      |

### 3.3 不同方法的结果比较

| 比较项 | 绝对差异 (m) | 相对差异 (%) |
|-------|------------|-------------|
| 牛顿法 vs 弦截法 | 0.0 | 0.0 |
| 牛顿法 vs fsolve | 0.0 | 0.0 |
| 弦截法 vs fsolve | 0.0 | 0.0 |

## 4. 分析与讨论

### 4.1 L1点的物理意义

L1点是地球和月球引力与离心力精确平衡的位置，卫星在此处可以保持相对静止。这种特性使其成为理想的观测位置：
1. 可同时持续观测地球和月球
2. 用于太阳观测任务（如SOHO卫星）
3. 作为深空探测的中继站
4. 监测地月空间环境

### 4.2 数值方法的比较

牛顿法优势：
- 二次收敛速度，迭代次数少
- 本问题中导数计算简单

弦截法优势：
- 不需要计算导数
- 对初值要求较低

共同特点：
- 都需要合理的初值选择
- 对单调函数收敛性好
- 本问题中均达到1e-8精度

### 4.3 思考题

1. 地球质量M增加时：
- 地球引力增强
- 平衡点向月球方向移动
- L1点位置r减小

2. 其他拉格朗日点：
- L2：月球外侧，用于月球背面通信
- L3：地球轨道对面，不稳定
- L4/L5：地月连线60°处，稳定
- 确定方法类似，需考虑不同力平衡条件

## 5. 结论

本实验成功确定了地月系统L1点的精确位置（3.26376×10⁸米），验证了数值方法在天体力学问题中的有效性。通过比较，牛顿法收敛更快，而弦截法实现更简单。L1点的平衡特性使其在空间任务中具有重要应用价值。

## 核心代码片段

```python
def lagrange_equation(r):
    earth_gravity = G * M / (r ** 2)
    moon_gravity = G * m / ((R - r) ** 2)
    centrifugal = omega ** 2 * r
    return earth_gravity - moon_gravity - centrifugal

def newton_method(f, df, x0, tol=1e-8, max_iter=100):
    x = x0
    for i in range(max_iter):
        fx = f(x)
        if abs(fx) < tol:
            return x, i+1, True
        dfx = df(x)
        x -= fx / dfx
        if abs(fx) < tol:
            return x, i+1, True
    return x, max_iter, False
```

代码说明：
lagrange_equation实现了L1点平衡方程，计算地球引力、月球引力和离心力的平衡。newton_method实现了牛顿迭代法，利用函数值和导数值进行快速收敛，设置了双重收敛条件保证精度。
